<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Kendall rank correlation coefficient (Kendall’s tau) – NAULearningDataScience</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../Notebooks/Morris_Elementary_Effects.html" rel="next">
<link href="../intro.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-8da5b4427184b79ecddefad3d342027e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Notebooks/Kendalls_tau.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Kendall rank correlation coefficient (Kendall’s tau)</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">NAULearningDataScience</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notebooks/Kendalls_tau.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Kendall rank correlation coefficient (Kendall’s tau)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notebooks/Morris_Elementary_Effects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Morris Sensitivity Analysis (Elementary Effects Method)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-probability-view" id="toc-the-probability-view" class="nav-link active" data-scroll-target="#the-probability-view">The “probability” view</a></li>
  <li><a href="#the-counting-pairwise-formula" id="toc-the-counting-pairwise-formula" class="nav-link" data-scroll-target="#the-counting-pairwise-formula">The counting (pairwise) formula</a></li>
  <li><a href="#compute-kendalls-tau-from-first-principles" id="toc-compute-kendalls-tau-from-first-principles" class="nav-link" data-scroll-target="#compute-kendalls-tau-from-first-principles">Compute Kendall’s Tau from first principles</a></li>
  <li><a href="#compare-manual-calculation-to-scipy.stats" id="toc-compare-manual-calculation-to-scipy.stats" class="nav-link" data-scroll-target="#compare-manual-calculation-to-scipy.stats">Compare manual calculation to scipy.stats</a></li>
  <li><a href="#adding-complexity" id="toc-adding-complexity" class="nav-link" data-scroll-target="#adding-complexity">Adding complexity</a></li>
  <li><a href="#real-world-example---countries-ranked-by-life-expectency-and-gdp" id="toc-real-world-example---countries-ranked-by-life-expectency-and-gdp" class="nav-link" data-scroll-target="#real-world-example---countries-ranked-by-life-expectency-and-gdp">real-world example - Countries Ranked by Life Expectency and GDP</a></li>
  <li><a href="#conceptual-questions" id="toc-conceptual-questions" class="nav-link" data-scroll-target="#conceptual-questions">CONCEPTUAL QUESTIONS</a></li>
  <li><a href="#spatial-rank-correlation" id="toc-spatial-rank-correlation" class="nav-link" data-scroll-target="#spatial-rank-correlation">Spatial Rank Correlation</a></li>
  <li><a href="#simulated-mcda-suitability" id="toc-simulated-mcda-suitability" class="nav-link" data-scroll-target="#simulated-mcda-suitability">simulated MCDA suitability</a></li>
  <li><a href="#review-questions" id="toc-review-questions" class="nav-link" data-scroll-target="#review-questions">Review Questions</a>
  <ul class="collapse">
  <li><a href="#conceptual" id="toc-conceptual" class="nav-link" data-scroll-target="#conceptual">Conceptual</a></li>
  <li><a href="#applied-interpretive" id="toc-applied-interpretive" class="nav-link" data-scroll-target="#applied-interpretive">Applied Interpretive</a></li>
  <li><a href="#answers" id="toc-answers" class="nav-link" data-scroll-target="#answers">Answers</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Kendall rank correlation coefficient (Kendall’s tau)</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In statistics, the <a href="https://en.wikipedia.org/wiki/Kendall_rank_correlation_coefficient">Kendall rank correlation coefficient</a>, commonly referred to as Kendall’s tau (τ), is a statistic used to measure the ordinal association between two measured quantities. A <strong>T test</strong> is a <a href="https://en.wikipedia.org/wiki/Non-parametric_statistics">non-parametric</a> <a href="https://en.wikipedia.org/wiki/Hypothesis_test">hypothesis test</a> for statistical dependence based on the <span class="math inline">\(T\)</span> coefficient. It is a measure of <a href="https://en.wikipedia.org/wiki/Rank_correlation">rank correlation</a>: the similarity of the orderings of data when ranked by each of the quantities. It is named after <a href="https://en.wikipedia.org/wiki/Maurice_Kendall">Maurice Kendall</a>, who developed it in 1938, though Gustav Fechner has proposed a similar measure in the context of time series in 1897.</p>
<p>Kendall’s motification was to create a rubust, intuitive measure of association between two rankings–one that was: - non parameteric – meaning it made no assumptions about the distribution of the data - intuative in interpretation – meaning it could be easily understood (based on concordant and discordant pairs) and - suitable for ordinal or ranked data (like preferences, ratings, or scores).</p>
<p>Before Kendall’s tau, other correlation measures like <a href="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient">Pearson’s correlation coefficient</a> were commonly used, but they assumed linear relationships and required interval or ratio data. Kendall’s tau provided a way to assess relationships in a more flexible manner, especially for non-linear or non-parametric data.</p>
<p>In many real-world problems, especially in decision analysis (also social sciences) data are often ordinal – things we can rank but not measure on a precise numerical scale.</p>
<p>For example: a hydrologist looking to build a groundwater recharge project, might want to rank potential sites based on suitability critiera, and rank them in suitability from 1 (low suitability) to 5 or 10 (high suitability). Kendall’s tau would allow the hydrologist to assess the association between different ranking criteria (like soil type, proximity to water sources, land use, etc.) without making assumptions about the underlying data distribution.</p>
<p>## How it works</p>
<p>Imagine two people rank the same set of sites independently based on their expert opinion of suitability for groundwater recharge.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>site</th>
<th>Rater A Rank</th>
<th>Rater B Rank</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>S1</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="even">
<td>S2</td>
<td>2</td>
<td>1</td>
</tr>
<tr class="odd">
<td>S3</td>
<td>3</td>
<td>4</td>
</tr>
<tr class="even">
<td>S4</td>
<td>4</td>
<td>3</td>
</tr>
<tr class="odd">
<td>S5</td>
<td>5</td>
<td>5</td>
</tr>
</tbody>
</table>
<p>Kendall’s tau looks at <strong>all possible pairs of sites</strong> (S1 vs S2, S1 vs S3, … S4 vs S5) and asks: - Do the two analysts agree on which site should be ranked higher?</p>
<p>For any pair of sites <span class="math inline">\((i, j)\)</span>: - The pair is <strong>concordant</strong> if both analysts put the same site higher.<br>
(Example: if <span class="math inline">\(A\)</span> says <span class="math inline">\(S2\)</span> better than <span class="math inline">\(S5\)</span>, and <span class="math inline">\(B\)</span> also says <span class="math inline">\(S2\)</span> better than <span class="math inline">\(S5\)</span>.) - The pair is <strong>discordant</strong> if the analysts disagree about which one is better.<br>
(Example: A says <span class="math inline">\(S1\)</span> better than <span class="math inline">\(S4\)</span>, but <span class="math inline">\(B\)</span> says <span class="math inline">\(S4\)</span> better than <span class="math inline">\(S1\)</span>.) - (Ties are possible in general, though not shown in this simple example. We handle those with slight variations of tau.)</p>
<p>Intuition: - If most pairs are concordant → <span class="math inline">\(\tau\)</span> is close to +1 (the rankings mostly agree). - If most pairs are discordant → <span class="math inline">\(\tau\)</span> is close to −1 (the rankings mostly disagree / almost inverted). - If agreement and disagreement are about equal → <span class="math inline">\(\tau\)</span> is near 0.</p>
<hr>
<section id="the-probability-view" class="level2">
<h2 class="anchored" data-anchor-id="the-probability-view">The “probability” view</h2>
<p>One clean way to define Kendall’s tau is:</p>
<p><span class="math display">\[
\tau = P(\text{concordant}) - P(\text{discordant})
\]</span></p>
<p>Here <span class="math inline">\(P(\text{concordant})\)</span> means:<br>
“Out of all possible pairs of items, what fraction of pairs are concordant?”</p>
<p>In other words, these are not probabilities in the sense of randomness over repeated experiments — they are proportions over all <span class="math inline">\(\frac{n(n-1)}{2}\)</span> pairs in <em>this</em> dataset.</p>
<p>So you can read <span class="math inline">\(\tau\)</span> as: &gt; “If I pick two items at random, how much more likely is it that the two rankings agree on their order than disagree?”</p>
<p>That’s the core interpretation.</p>
<hr>
</section>
<section id="the-counting-pairwise-formula" class="level2">
<h2 class="anchored" data-anchor-id="the-counting-pairwise-formula">The counting (pairwise) formula</h2>
<p>Let: - <span class="math inline">\(n\)</span> = number of items being ranked<br>
- <span class="math inline">\(C\)</span> = number of concordant pairs<br>
- <span class="math inline">\(D\)</span> = number of discordant pairs<br>
- <span class="math inline">\(T = \frac{n(n-1)}{2}\)</span> = total number of distinct pairs</p>
<p>Then Kendall’s tau can be written as:</p>
<p><span class="math display">\[
\tau = \frac{C - D}{T}
= \frac{C - D}{\frac{1}{2} n (n - 1)}
\]</span></p>
<p>This is the same as the “probability” version, just written in terms of counts instead of proportions: - <span class="math inline">\(\frac{C}{T}\)</span> is <span class="math inline">\(P(\text{concordant})\)</span> - <span class="math inline">\(\frac{D}{T}\)</span> is <span class="math inline">\(P(\text{discordant})\)</span></p>
<p>So: <span class="math display">\[
\tau = \frac{C}{T} - \frac{D}{T}
\]</span></p>
<hr>
<p>In practice, we’ll compute <span class="math inline">\(C\)</span> and <span class="math inline">\(D\)</span> from two ranked lists, calculate <span class="math inline">\(\tau\)</span>, and then visualize where disagreements are happening spatially or across alternatives.</p>
<p>Next, we’ll implement this calculation in Python, both “by hand” (to see C and D) and using <code>scipy.stats.kendalltau</code>.</p>
<blockquote class="blockquote">
<p>Now lets explore how to calculate Kendall’s tau using Python.</p>
</blockquote>
<div id="0ec83c94" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import pandas to create an manipulate dataframes</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create a sample dataframe with rankings from two analysts</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame({</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Site"</span>: [<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>, <span class="st">"F"</span>],</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Rank_Analyst1"</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>],  <span class="co"># Analyst 1 thinks A&gt;B&gt;C&gt;D&gt;E&gt;F</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Rank_Analyst2"</span>: [<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">5</span>]   <span class="co"># Analyst 2 mostly agrees, but swaps B/C and E/F</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Site</th>
<th data-quarto-table-cell-role="th">Rank_Analyst1</th>
<th data-quarto-table-cell-role="th">Rank_Analyst2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>A</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>B</td>
<td>2</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>C</td>
<td>3</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>D</td>
<td>4</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>E</td>
<td>5</td>
<td>6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>F</td>
<td>6</td>
<td>5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<blockquote class="blockquote">
<p>Ok, now lets create a function that checks all possible pairings rankings to determine concordant (agreeing) and discordant (disagreeing) pairs.</p>
</blockquote>
<div id="fce26fcc" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># itertools is a useful library for creating combinations and permutations</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> itertools</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> kendall_concordance_table(df, col_x, col_y):</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Create a table showing concordant and discordant pairs between two rankings.</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">    df: DataFrame with rankings</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">    col_x: column name for first ranking</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">    col_y: column name for second ranking</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns a DataFrame with pairwise comparisons and counts of concordant/discordant pairs.</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    pairs_info <span class="op">=</span> [] <span class="co"># to store info about each pair</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    C <span class="op">=</span> <span class="dv">0</span>  <span class="co"># concordant = they agree on order</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    D <span class="op">=</span> <span class="dv">0</span>  <span class="co"># discordant = they disagree on order</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i, j) <span class="kw">in</span> itertools.combinations(df.index, <span class="dv">2</span>): <span class="co"># for all unique pairs of indices (i, j)</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>        x_i <span class="op">=</span> df.loc[i, col_x] <span class="co"># x_i is the rank of item i in ranking x</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>        x_j <span class="op">=</span> df.loc[j, col_x] <span class="co"># x_j is the rank of item j in ranking x</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>        y_i <span class="op">=</span> df.loc[i, col_y] <span class="co"># y_i is the rank of item i in ranking y</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>        y_j <span class="op">=</span> df.loc[j, col_y] <span class="co"># y_j is the rank of item j in ranking y</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>        site_i <span class="op">=</span> df.loc[i, <span class="st">"Site"</span>] <span class="co"># get site names for reporting for item i</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>        site_j <span class="op">=</span> df.loc[j, <span class="st">"Site"</span>] <span class="co"># get site names for reporting for item j</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Compare pair ordering in each ranking</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>        diff_x <span class="op">=</span> x_i <span class="op">-</span> x_j <span class="co"># difference in ranking for pair (i, j) in ranking x</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>        diff_y <span class="op">=</span> y_i <span class="op">-</span> y_j <span class="co"># difference in ranking for pair (i, j) in ranking y</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># If both differences have same sign -&gt; concordant</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># If opposite sign -&gt; discordant</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># If diff_x or diff_y == 0, that's a tie (we'll just mark it)</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> diff_x <span class="op">*</span> diff_y <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>            relation <span class="op">=</span> <span class="st">"concordant"</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>            C <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> diff_x <span class="op">*</span> diff_y <span class="op">&lt;</span> <span class="dv">0</span>:</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>            relation <span class="op">=</span> <span class="st">"discordant"</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>            D <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>            relation <span class="op">=</span> <span class="st">"tie"</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>        pairs_info.append({</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Pair"</span>: <span class="ss">f"</span><span class="sc">{</span>site_i<span class="sc">}</span><span class="ss">-</span><span class="sc">{</span>site_j<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"Order in </span><span class="sc">{</span>col_x<span class="sc">}</span><span class="ss">"</span>: <span class="st">"i&lt;j"</span> <span class="cf">if</span> diff_x <span class="op">&lt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">"i&gt;j"</span>,</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"Order in </span><span class="sc">{</span>col_y<span class="sc">}</span><span class="ss">"</span>: <span class="st">"i&lt;j"</span> <span class="cf">if</span> diff_y <span class="op">&lt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">"i&gt;j"</span>,</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Relation"</span>: relation</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>    pairs_df <span class="op">=</span> pd.DataFrame(pairs_info)</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pairs_df, C, D</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Now let's use the function on our sample data</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>pairs_df, C, D <span class="op">=</span> kendall_concordance_table(data, <span class="st">"Rank_Analyst1"</span>, <span class="st">"Rank_Analyst2"</span>)</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Concordant pairs (C): </span><span class="sc">{</span>C<span class="sc">}</span><span class="ss">, Discordant pairs (D): </span><span class="sc">{</span>D<span class="sc">}</span><span class="ss">"</span>) <span class="co"># print out the counts of concordant and discordant pairs</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>pairs_df <span class="co"># print the output table from the function: kendall_concordance_table()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Concordant pairs (C): 13, Discordant pairs (D): 2</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Pair</th>
<th data-quarto-table-cell-role="th">Order in Rank_Analyst1</th>
<th data-quarto-table-cell-role="th">Order in Rank_Analyst2</th>
<th data-quarto-table-cell-role="th">Relation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>A-B</td>
<td>i&lt;j</td>
<td>i&lt;j</td>
<td>concordant</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>A-C</td>
<td>i&lt;j</td>
<td>i&lt;j</td>
<td>concordant</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>A-D</td>
<td>i&lt;j</td>
<td>i&lt;j</td>
<td>concordant</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>A-E</td>
<td>i&lt;j</td>
<td>i&lt;j</td>
<td>concordant</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>A-F</td>
<td>i&lt;j</td>
<td>i&lt;j</td>
<td>concordant</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>B-C</td>
<td>i&lt;j</td>
<td>i&gt;j</td>
<td>discordant</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>B-D</td>
<td>i&lt;j</td>
<td>i&lt;j</td>
<td>concordant</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>B-E</td>
<td>i&lt;j</td>
<td>i&lt;j</td>
<td>concordant</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>B-F</td>
<td>i&lt;j</td>
<td>i&lt;j</td>
<td>concordant</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>C-D</td>
<td>i&lt;j</td>
<td>i&lt;j</td>
<td>concordant</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>C-E</td>
<td>i&lt;j</td>
<td>i&lt;j</td>
<td>concordant</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>C-F</td>
<td>i&lt;j</td>
<td>i&lt;j</td>
<td>concordant</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>D-E</td>
<td>i&lt;j</td>
<td>i&lt;j</td>
<td>concordant</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>D-F</td>
<td>i&lt;j</td>
<td>i&lt;j</td>
<td>concordant</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>E-F</td>
<td>i&lt;j</td>
<td>i&gt;j</td>
<td>discordant</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="compute-kendalls-tau-from-first-principles" class="level2">
<h2 class="anchored" data-anchor-id="compute-kendalls-tau-from-first-principles">Compute Kendall’s Tau from first principles</h2>
<p>Next we will compute Kendall’s tau manually using Python.</p>
<p><em>remember that tau is the difference between the probability of concordant and discordant pairs.</em></p>
<p>For <span class="math inline">\(n\)</span> items, the total number of distince pairs is given by the formula: <span class="math inline">\(T = \frac{n(n-1)}{2}\)</span>.</p>
<p>Then, we can use the output of the function above which counted the number of concordant and discordant pairs to compute kendall’s tau.</p>
<div id="044e4a30" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np <span class="co"># for numerical operations we use numpy</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="bu">len</span>(data) <span class="co"># number of items being ranked</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>total_pairs <span class="op">=</span> n <span class="op">*</span> (n <span class="op">-</span> <span class="dv">1</span>) <span class="op">/</span> <span class="dv">2</span> <span class="co"># total number of distinct pairs T</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>tau_manual <span class="op">=</span> (C <span class="op">-</span> D) <span class="op">/</span> total_pairs <span class="co"># Kendall's tau formula</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f" C = </span><span class="sc">{</span>C<span class="sc">}</span><span class="ss">, D = </span><span class="sc">{</span>D<span class="sc">}</span><span class="ss">, Total pairs (T): </span><span class="sc">{</span>total_pairs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Kendall's tau (manual calculation): </span><span class="sc">{</span>tau_manual<span class="sc">:.3f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> C = 13, D = 2, Total pairs (T): 15.0
Kendall's tau (manual calculation): 0.733</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Interpreting the results</p>
</blockquote>
<p>if tau is close to +1, the rankings mostly agree if tau is close to 0.5, mostly agree but with notable flips if tau is close to -1, the rankings mostly disagree if tau is close to -0.5, mostly disagree but with agreements if tau is close to 0, there is little association between the rankings</p>
<p>For this synthetic dataset we should see <span class="math inline">\(\tau\)</span> as high but not 1 because those B vs C and E vs F swaps create discordance.</p>
<blockquote class="blockquote">
<p>Next lets visualize the agreement and disagreement between the two rankings.</p>
</blockquote>
<p>To do this we will plot…</p>
<div id="e5f8ecfe" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>color_map <span class="op">=</span> { <span class="st">'concordant'</span>: <span class="st">'green'</span>, <span class="st">'discordant'</span>: <span class="st">'red'</span>, <span class="st">"tie"</span>: <span class="st">'gray'</span> }</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>pair_counts <span class="op">=</span> pairs_df[<span class="st">"Relation"</span>].value_counts()</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>bars <span class="op">=</span> plt.bar(pair_counts.index, pair_counts.values,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>               color<span class="op">=</span>[color_map[r] <span class="cf">for</span> r <span class="kw">in</span> pair_counts.index])</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Number of Pairs"</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Counts of Concordant and Discordant Pairs"</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Kendalls_tau_files/figure-html/cell-5-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>So looking at the figure we can see that most of the pairs are concordant, we have a few discordant pairs (in red) and no ties (gray). We got a kendall’s tau of 0.733 which indicates a strong positive association between the two rankings.</p>
</section>
<section id="compare-manual-calculation-to-scipy.stats" class="level2">
<h2 class="anchored" data-anchor-id="compare-manual-calculation-to-scipy.stats">Compare manual calculation to scipy.stats</h2>
<p>Now that we understand the basic calculation of Kendall’s tau, lets try to use the scipy.stats version of kendall’s tau to see if we get the same results and how our manual calculation compares to the built-in function in scipy.stats</p>
<div id="b32cb113" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> kendalltau <span class="co"># import kendalltau from scipy.stats</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># recall the structure of our data</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data.columns) <span class="co"># show column names</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>data.head(<span class="dv">5</span>) <span class="co"># show first 5 rows of data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['Site', 'Rank_Analyst1', 'Rank_Analyst2'], dtype='object')</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Site</th>
<th data-quarto-table-cell-role="th">Rank_Analyst1</th>
<th data-quarto-table-cell-role="th">Rank_Analyst2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>A</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>B</td>
<td>2</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>C</td>
<td>3</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>D</td>
<td>4</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>E</td>
<td>5</td>
<td>6</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="92666157" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>tau_scipy, p_value <span class="op">=</span> kendalltau(data[<span class="st">"Rank_Analyst1"</span>], data[<span class="st">"Rank_Analyst2"</span>])</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Kendall's tau (scipy.stats): </span><span class="sc">{</span>tau_scipy<span class="sc">:.3f}</span><span class="ss">, p-value: </span><span class="sc">{</span>p_value<span class="sc">:.3f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Kendall's tau (scipy.stats): 0.733, p-value: 0.056</code></pre>
</div>
</div>
<p>Notice that both our manual calculation and scipy’s kendalltau function give the same result of approximately 0.733, confirming the correctness of our manual implementation. But the scipy function also provides a p-value for testing the hypothesis of no association (<span class="math inline">\(\tau = 0\)</span>)</p>
<p>So the scipy version does two things:</p>
<ol type="1">
<li>It computes Kendall’s tau using an efficient algorithm measuring the strength of <a href="https://en.wikipedia.org/wiki/Monotonic_function">monotonic</a> association between two rankings.</li>
<li>It provides a p-value for testing the null hypothesis that there is no association between the two rankings (i.e., <span class="math inline">\(\tau = 0\)</span>). A low p-value (typically &lt; 0.05) indicates that we can reject the null hypothesis and conclude that there is a statistically significant association between the rankings.</li>
</ol>
<p>Here we got a p-value of approximately 0.056, which indicates that the association is marginally significant at the 0.05 level. This suggests that while there is a positive association between the rankings, we should be cautious in interpreting it as statistically significant. Why? Because our sample dataset is small (only 5 items), with a such a small number of pairs its more likely that random chance could produce similar levels of concordance. lets see what happens when we increase the size of the dataset.</p>
</section>
<section id="adding-complexity" class="level2">
<h2 class="anchored" data-anchor-id="adding-complexity">Adding complexity</h2>
<p>To further explore the behavior of Kendall’s tau, we can increase the size of our dataset from 6 sites to 30. We will randomly generate base ranking, then create a slightly “noisy” version to simulate small differences in judgement or weight perturbations.</p>
<div id="1988a13c" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">32</span>)  <span class="co"># for reproducibility</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">100</span> <span class="co"># change this and re-run as well to see the effect of sample size </span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>swap_n <span class="op">=</span> <span class="dv">30</span> <span class="co"># number of swaps to introduce, change this value and re-run to see different levels of disagreement</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyst A: perfect ranking 1 -&gt; n</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>rank_A <span class="op">=</span> np.arange(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>) <span class="co"># Analyst A ranks items from 1 to n</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyst B: same order bit with some random swaps (simulateing disagreement)</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>rank_B <span class="op">=</span> rank_A.copy() <span class="co"># start with same ranking as Analyst A</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>swap_indices <span class="op">=</span> np.random.choice(n, size<span class="op">=</span>swap_n, replace<span class="op">=</span><span class="va">False</span>) <span class="co"># choose 5 random indices to swap</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>np.random.shuffle(swap_indices) <span class="co"># shuffle the selected indices</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>rank_B[swap_indices] <span class="op">=</span> rank_B[np.random.permutation(swap_indices)]  <span class="co"># perform the swaps</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>tau, p_value <span class="op">=</span> kendalltau(rank_A, rank_B)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Kendall's tau between Analyst A and B: </span><span class="sc">{</span>tau<span class="sc">:.3f}</span><span class="ss">, p-value: </span><span class="sc">{</span>p_value<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the rankings in a scatter plot</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>,<span class="dv">5</span>))</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>plt.scatter(rank_A, rank_B)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>plt.plot([<span class="dv">0</span>,n],[<span class="dv">0</span>,n],<span class="st">'k--'</span>,alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Analyst A rank"</span>)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Analyst B rank"</span>)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f"n = </span><span class="sc">{</span>n<span class="sc">}</span><span class="ss">, τ = </span><span class="sc">{</span>tau<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Kendall's tau between Analyst A and B: 0.593, p-value: 0.000</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Kendalls_tau_files/figure-html/cell-8-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Next lets add noise a different way.</p>
</blockquote>
<p>First we will create a set of data, we will call <em>base_scores</em> we will just take <span class="math inline">\(n\)</span> numbers spaced equally from 0 to 1</p>
<p>then we will create alternative scores which are the base_scores with some noise added, noise from a random normal distribution.</p>
<div id="9901761d" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">19</span> <span class="co"># change this depending on the sample size you want</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>noise_factor <span class="op">=</span> <span class="fl">0.08</span> <span class="co"># this is the standard devation of the distribution from which the noise is generated, try 0.1, 0.05, 1, see how this affects kendalls tau</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>base_scores <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">1</span>,n)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">#print(f"base_scores {base_scores}")</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>noise <span class="op">=</span> np.random.normal (<span class="dv">0</span>,noise_factor,n) <span class="co"># create noise by drawing random samples from a normal gaussian distribution</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>alt_scores <span class="op">=</span> base_scores <span class="op">+</span> noise <span class="co"># add the noise to the base scores to create alternative scores</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co">#print(f"alt scores (base scores + noise) {alt_scores}")</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>rank_base <span class="op">=</span> pd.Series(base_scores).rank() <span class="co"># rank the original scores, (remember we want ranks not scores)</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>rank_alt <span class="op">=</span> pd.Series(alt_scores).rank() <span class="co"># the base scores have been changed a bit randomly so they will rank differently when their rank is calculated</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co"># now lets calculate kendall's tau</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>tau, p_value <span class="op">=</span> kendalltau(rank_base, rank_alt)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"τ = </span><span class="sc">{</span>tau<span class="sc">:.3f}</span><span class="ss">; pvalue = </span><span class="sc">{</span>p_value<span class="sc">:.5f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>τ = 0.860; pvalue = 0.00000</code></pre>
</div>
</div>
<div id="d063a1b6" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the relationship between rank_base, and rank_alt (our two different rankings)</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">4</span>))</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>plt.scatter(base_scores, alt_scores)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Suitability A"</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Suitability B (perturbed)"</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f"Kendall’s τ = </span><span class="sc">{</span>tau<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Kendalls_tau_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Lets now look at how changing the level of noise in the data affects the kendalls tau</p>
</blockquote>
<p>We will generate many random pertubations and compute <span class="math inline">\(\tau\)</span> each time. This mimics the way sensitivity analysis samples random weight combinations in a Weighted Linear Combination (WLC). basically we are looking at the kendall’s tau through time, and automating the changing of the standard devation within the noise addition to see how adding different levels of noise affects kendall’s tau.</p>
<div id="5ae34b9e" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>noise_levels <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">20</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co">#print(noise_levels)</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>taus <span class="op">=</span> []</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> s <span class="kw">in</span> noise_levels:</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    alt <span class="op">=</span> base_scores <span class="op">+</span> np.random.normal(<span class="dv">0</span> , s , n) <span class="co"># recall n is defined above in previous example as is base_scores</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    taus.append(kendalltau(pd.Series(base_scores).rank(), pd.Series(alt).rank())[<span class="dv">0</span>])</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>plt.plot(noise_levels, taus, marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Noise (std dev)"</span>)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Kendall’s τ"</span>)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Rank stability vs. perturbation level"</span>)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Kendalls_tau_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>you can see from the above figure that as noise increases kendall’s tau a measure of similarity between rankings decreases, rank stability decreases.</p>
</blockquote>
</section>
<section id="real-world-example---countries-ranked-by-life-expectency-and-gdp" class="level2">
<h2 class="anchored" data-anchor-id="real-world-example---countries-ranked-by-life-expectency-and-gdp">real-world example - Countries Ranked by Life Expectency and GDP</h2>
<p>Ok, enough with fake data sets, lets step away from the hard sciences for a second and look at something more social. Lets look at how life expectancy compares to GDP, we would think life expectancy is higher in rich countries and lower in poor countries. So we can get the data on life expectancy, and we can get the data on GDP, then rank the countries in order of GDP and life expectancy, and compare how these two different ways to rank countries are concordant or discordant using Kendalls Tau</p>
<blockquote class="blockquote">
<p>to see how we cleaned and created these datasets see this notebook: <code>Data\DataWranglingScripts\GDPvLifeExpectency2022_countries_ranked.ipynb</code></p>
</blockquote>
<div id="5e3fb85c" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"../Data/CLEAN/GDP_LifeExpectancy_2022_Clean.csv"</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.head())</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Country Name Country Code   GDP_PC_2022  LIFE_EX_YRS_2022  \
0                        Aruba          ABW  30559.533535         73.537000   
1  Africa Eastern and Southern          AFE   1628.318944         61.765707   
2                  Afghanistan          AFG    357.261153         63.941000   
3   Africa Western and Central          AFW   1796.668633         56.906135   
4                       Angola          AGO   2929.694455         61.748000   

   GDP_PC_RANK_2022  LIFE_EX_YRS_RANK_2022  
0              56.0                   86.0  
1             216.0                  220.0  
2             255.0                  203.0  
3             210.0                  251.0  
4             187.0                  221.0  
Index(['Country Name', 'Country Code', 'GDP_PC_2022', 'LIFE_EX_YRS_2022',
       'GDP_PC_RANK_2022', 'LIFE_EX_YRS_RANK_2022'],
      dtype='object')</code></pre>
</div>
</div>
<div id="948178cb" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>tau, pval <span class="op">=</span> kendalltau(df[<span class="st">"GDP_PC_RANK_2022"</span>], df[<span class="st">"LIFE_EX_YRS_RANK_2022"</span>])</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Kendall's tau (τ) = </span><span class="sc">{</span>tau<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value = </span><span class="sc">{</span>pval<span class="sc">:.8f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Kendall's tau (τ) = 0.651
p-value = 0.00000000</code></pre>
</div>
</div>
<p>We see a strong positive rank correlation, which is what we would expect. Wealthier countries generally have longer life expectancy, though the relationship isnt perfect. Now lets visualize the data.</p>
<div id="278273b9" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">7</span>,<span class="dv">7</span>))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"GDP_PC_RANK_2022"</span>],</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"LIFE_EX_YRS_RANK_2022"</span>],</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.7</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    edgecolor<span class="op">=</span><span class="st">"k"</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    linewidth<span class="op">=</span><span class="fl">0.3</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a diagonal "perfect agreement" line</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>plt.plot(</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">1</span>, df[<span class="st">"GDP_PC_RANK_2022"</span>].<span class="bu">max</span>()],</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">1</span>, df[<span class="st">"LIFE_EX_YRS_RANK_2022"</span>].<span class="bu">max</span>()],</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'k--'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, label<span class="op">=</span><span class="st">"Perfect rank agreement"</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"GDP per capita rank (1 = richest)"</span>)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Life expectancy rank (1 = longest-lived)"</span>)</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f"Country Rank Agreement</span><span class="ch">\n</span><span class="ss">Kendall’s τ = </span><span class="sc">{</span>tau<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Flip axes so 'better' (rank 1) appears top-right</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>plt.gca().invert_xaxis()</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>plt.gca().invert_yaxis()</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Kendalls_tau_files/figure-html/cell-14-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Next we will zoom in on the top 40 countries in terms of GDP and see if the kendalls tau is better or worse when we exclude all but the 40 richest.</p>
<div id="52e102fc" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by GDP rank (1 = richest)</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>df_top40 <span class="op">=</span> (</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    df</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    .sort_values(<span class="st">"GDP_PC_RANK_2022"</span>, ascending<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    .head(<span class="dv">40</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    .copy()</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_top40[[<span class="st">"Country Name"</span>, <span class="st">"GDP_PC_RANK_2022"</span>, <span class="st">"LIFE_EX_YRS_RANK_2022"</span>]].head())</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Number of countries in subset: </span><span class="sc">{</span><span class="bu">len</span>(df_top40)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Country Name  GDP_PC_RANK_2022  LIFE_EX_YRS_RANK_2022
144         Monaco               1.0                    2.0
133  Liechtenstein               2.0                    3.0
140     Luxembourg               3.0                   14.0
27         Bermuda               4.0                   42.0
172         Norway               5.0                   11.0
Number of countries in subset: 40</code></pre>
</div>
</div>
<div id="e700a743" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>tau_top, pval_top <span class="op">=</span> kendalltau(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    df_top40[<span class="st">"GDP_PC_RANK_2022"</span>],</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    df_top40[<span class="st">"LIFE_EX_YRS_RANK_2022"</span>]</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Kendall’s τ (top 40 richest) = </span><span class="sc">{</span>tau_top<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value = </span><span class="sc">{</span>pval_top<span class="sc">:.8f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Kendall’s τ (top 40 richest) = 0.248
p-value = 0.02515424</code></pre>
</div>
</div>
<div id="e3526682" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df_top40[<span class="st">"RankGap"</span>] <span class="op">=</span> (</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    df_top40[<span class="st">"GDP_PC_RANK_2022"</span>] <span class="op">-</span> df_top40[<span class="st">"LIFE_EX_YRS_RANK_2022"</span>]</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">8</span>))</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>scatter <span class="op">=</span> plt.scatter(</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    df_top40[<span class="st">"GDP_PC_RANK_2022"</span>],</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    df_top40[<span class="st">"LIFE_EX_YRS_RANK_2022"</span>],</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    c<span class="op">=</span>df_top40[<span class="st">"RankGap"</span>],</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    cmap<span class="op">=</span><span class="st">"RdBu_r"</span>,</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    s<span class="op">=</span><span class="dv">70</span>,</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    edgecolor<span class="op">=</span><span class="st">"k"</span>,</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    linewidth<span class="op">=</span><span class="fl">0.4</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>plt.colorbar(scatter, label<span class="op">=</span><span class="st">"Rank Gap (GDP − Life Exp)"</span>)</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>plt.plot(</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">1</span>, df_top40[<span class="st">"GDP_PC_RANK_2022"</span>].<span class="bu">max</span>()],</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">1</span>, df_top40[<span class="st">"LIFE_EX_YRS_RANK_2022"</span>].<span class="bu">max</span>()],</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'k--'</span>, alpha<span class="op">=</span><span class="fl">0.4</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, row <span class="kw">in</span> df_top40.iterrows():</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>    plt.text(</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>        row[<span class="st">"GDP_PC_RANK_2022"</span>] <span class="op">+</span> <span class="fl">0.2</span>,</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>        row[<span class="st">"LIFE_EX_YRS_RANK_2022"</span>],</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>        row[<span class="st">"Country Name"</span>],</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>        fontsize<span class="op">=</span><span class="dv">8</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"GDP per capita rank (1 = richest)"</span>)</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Life expectancy rank (1 = longest-lived)"</span>)</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f"Top 40 Wealthiest Countries: Over / Under-Performers</span><span class="ch">\n</span><span class="ss">τ = </span><span class="sc">{</span>tau_top<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>plt.gca().invert_xaxis()</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>plt.gca().invert_yaxis()</span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Kendalls_tau_files/figure-html/cell-17-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The analysis of country rank in terms of GDP per capita vs life expectancy using Kendall’s tau tells us that overall life expectency is correlated with GDP per capita in terms of how contries compare to eachother (rank), however the correlation is much worse in the rich countries, why might that be?</p>
</section>
<section id="conceptual-questions" class="level2">
<h2 class="anchored" data-anchor-id="conceptual-questions">CONCEPTUAL QUESTIONS</h2>
<ol type="1">
<li>Is Kendall’s Tau a good way to measure the correlation of these two variables?</li>
</ol>
<blockquote class="blockquote">
<p>answer: Its more approriate to look at how the Life Expectency values compare to the GDP per capita directly using Pearson’s R, which compares one number to another. Kendall’s Tau is for comparing the ranks, so the colored rank figure shows us that countries below the line, are under performing in terms of life expectancy vs GDP relative to their neighbors. It is also telling us the the GDP life expectency relationship breaks down at higher levels of GDP or is less meaningful.</p>
</blockquote>
<ol start="2" type="1">
<li>Why might this relationship breakdown when subsetting the data to only the richest countries?</li>
</ol>
</section>
<section id="spatial-rank-correlation" class="level2">
<h2 class="anchored" data-anchor-id="spatial-rank-correlation">Spatial Rank Correlation</h2>
<blockquote class="blockquote">
<p>Using Kendalls Tau for suitability mapping sensitivity Analysis</p>
</blockquote>
<p>In a Weighted Linear Combination (WLC) or other GIS-MCDA, you often generate suitability rasters under different weighting schemes, e.g.:</p>
<ul>
<li><p>Scenario A: baseline weights (e.g., 40% slope, 30% soil, 30% rainfall)</p></li>
<li><p>Scenario B: modified weights (e.g., 30% slope, 40% soil, 30% rainfall)</p></li>
</ul>
<p>Each raster cell gets a suitability score. You can rank cells (1 = most suitable) for each scenario, then compute Kendall’s <span class="math inline">\(\tau\)</span> between the two rankings.</p>
</section>
<section id="simulated-mcda-suitability" class="level2">
<h2 class="anchored" data-anchor-id="simulated-mcda-suitability">simulated MCDA suitability</h2>
<p>We will build two small 10x10 rasteres (100 cells):</p>
<p>suitability_A –&gt; Baseline Scenario suitability_B –&gt; slightly perturbed version (change one weight layer)</p>
<ol type="1">
<li><p>Then flatted both to 1D arrays (each cell = one observation)</p></li>
<li><p>compute <span class="math inline">\(\tau\)</span> for the full map</p></li>
<li><p>visualize where ranks changed the most.</p></li>
</ol>
<div id="2b1cb740" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Step 1: create two synthetic suitability grids (values 1–10) ---</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>grid_size <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>suitability_A <span class="op">=</span> np.random.rand(grid_size, grid_size) <span class="op">*</span> <span class="dv">9</span> <span class="op">+</span> <span class="dv">1</span>  <span class="co"># values in [1,10]</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>suitability_B <span class="op">=</span> suitability_A <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="fl">0.02</span>, (grid_size, grid_size))  <span class="co"># add mild noise</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>suitability_B <span class="op">=</span> np.clip(suitability_B, <span class="dv">1</span>, <span class="dv">10</span>)  <span class="co"># keep within same range</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>diff <span class="op">=</span> suitability_A <span class="op">-</span> suitability_B</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Step 2: plot them side-by-side ---</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">4</span>))</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>im1 <span class="op">=</span> axes[<span class="dv">0</span>].imshow(suitability_A, cmap<span class="op">=</span><span class="st">"YlGn"</span>, vmin<span class="op">=</span><span class="dv">1</span>, vmax<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">"Scenario A — Baseline"</span>)</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].axis(<span class="st">"off"</span>)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>plt.colorbar(im1, ax<span class="op">=</span>axes[<span class="dv">0</span>], fraction<span class="op">=</span><span class="fl">0.046</span>, pad<span class="op">=</span><span class="fl">0.04</span>, label<span class="op">=</span><span class="st">"Suitability (1–10)"</span>)</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>im2 <span class="op">=</span> axes[<span class="dv">1</span>].imshow(suitability_B, cmap<span class="op">=</span><span class="st">"YlGn"</span>, vmin<span class="op">=</span><span class="dv">1</span>, vmax<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">"Scenario B — Perturbed"</span>)</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].axis(<span class="st">"off"</span>)</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>plt.colorbar(im2, ax<span class="op">=</span>axes[<span class="dv">1</span>], fraction<span class="op">=</span><span class="fl">0.046</span>, pad<span class="op">=</span><span class="fl">0.04</span>, label<span class="op">=</span><span class="st">"Suitability (1–10)"</span>)</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>im3 <span class="op">=</span> axes[<span class="dv">2</span>].imshow(diff, cmap <span class="op">=</span> <span class="st">'RdBu'</span>, vmin <span class="op">=</span> diff.<span class="bu">min</span>(), vmax <span class="op">=</span> diff.<span class="bu">max</span>())</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_title(<span class="st">"Difference (added noise)"</span>)</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].axis(<span class="st">'off'</span>)</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>plt.colorbar(im3, ax<span class="op">=</span>axes[<span class="dv">2</span>], fraction<span class="op">=</span><span class="fl">0.046</span>, pad <span class="op">=</span> <span class="fl">0.04</span>, label<span class="op">=</span><span class="st">"Difference"</span>)</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Kendalls_tau_files/figure-html/cell-18-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="098d30ee" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Step 3: compute Kendall’s tau on the flattened ranks ---</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>A_flat <span class="op">=</span> suitability_A.flatten()</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>B_flat <span class="op">=</span> suitability_B.flatten()</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>rank_A <span class="op">=</span> pd.Series(A_flat).rank()</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>rank_B <span class="op">=</span> pd.Series(B_flat).rank()</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>tau, pval <span class="op">=</span> kendalltau(rank_A, rank_B)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Overall spatial Kendall’s τ = </span><span class="sc">{</span>tau<span class="sc">:.3f}</span><span class="ss"> -- Pvalue: </span><span class="sc">{</span>pval<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Overall spatial Kendall’s τ = 0.997 -- Pvalue: 0.0000</code></pre>
</div>
</div>
<div id="f50e0d35" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>rank_diff <span class="op">=</span> (rank_B <span class="op">-</span> rank_A).values.reshape(grid_size, grid_size)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">5</span>))</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>plt.imshow(rank_diff, cmap<span class="op">=</span><span class="st">"BrBG"</span>, vmin<span class="op">=</span>rank_diff.<span class="bu">min</span>(), vmax<span class="op">=</span>rank_diff.<span class="bu">max</span>())</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>plt.colorbar(label<span class="op">=</span><span class="st">"Rank difference (B − A)"</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Spatial distribution of rank changes"</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">"off"</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Kendalls_tau_files/figure-html/cell-20-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="review-questions" class="level2">
<h2 class="anchored" data-anchor-id="review-questions">Review Questions</h2>
<section id="conceptual" class="level3">
<h3 class="anchored" data-anchor-id="conceptual">Conceptual</h3>
<ol type="1">
<li><p>What type of relationship does Kendall’s rank correlation coefficient (<span class="math inline">\(\tau\)</span>) measure between two variables?</p></li>
<li><p>In what ways does Kendall’s <span class="math inline">\(\tau\)</span> differ from Pearson’s <span class="math inline">\(r\)</span> correlation coefficient?</p></li>
<li><p>What do we mean by a concordant pair and a discordant pair in the context of Kendall’s <span class="math inline">\(\tau\)</span>?</p></li>
<li><p>Write the general formula for Kendall’s <span class="math inline">\(\tau\)</span> in terms of the number of concordant (<span class="math inline">\(C\)</span>) and discordant (<span class="math inline">\(D\)</span>) pairs, and the total number of pairs (<span class="math inline">\(T\)</span>).</p></li>
<li><p>What does a <span class="math inline">\(\tau\)</span> value of <span class="math inline">\(+1\)</span>, <span class="math inline">\(0\)</span>, and <span class="math inline">\(-1\)</span> indicate about the association between two rankings?</p></li>
<li><p>Why is Kendall’s <span class="math inline">\(\tau\)</span> considered a non-parametric statistic? What assumption does it avoid that Pearson’s <span class="math inline">\(r\)</span> requires?</p></li>
<li><p>Explain how tied ranks affect the calculation of Kendall’s <span class="math inline">\(\tau\)</span>. What adjustments are sometimes made to account for ties?</p></li>
<li><p>How can Kendall’s <span class="math inline">\(\tau\)</span> be interpreted as a difference in probabilities between concordant and discordant pairs?</p></li>
<li><p>What is the computational relationship between Kendall’s <span class="math inline">\(\tau\)</span> and Spearman’s <span class="math inline">\(\rho\)</span> in terms of how they treat rank differences?</p></li>
<li><p>Why might Kendall’s <span class="math inline">\(\tau\)</span> be preferred over Pearson’s <span class="math inline">\(r\)</span> when comparing ordinal data such as survey responses or ranked preferences?</p></li>
</ol>
</section>
<section id="applied-interpretive" class="level3">
<h3 class="anchored" data-anchor-id="applied-interpretive">Applied Interpretive</h3>
<ol start="11" type="1">
<li><p>Suppose two analysts rank five sites for groundwater recharge suitability. Analyst A’s and B’s rankings are nearly identical except for one swapped pair. Would you expect <span class="math inline">\(\tau\)</span> to be closer to 1, 0, or -1? Why?</p></li>
<li><p>If a scatter plot of ranks shows that higher values of one ranking generally correspond to higher values of the other but with some local reversals, what approximate range of <span class="math inline">\(\tau\)</span> would you expect?</p></li>
</ol>
</section>
<section id="answers" class="level3">
<h3 class="anchored" data-anchor-id="answers">Answers</h3>
<blockquote class="blockquote">
<p><em>1. Kendall’s rank correlation coefficient (<span class="math inline">\(\tau\)</span>) measures the strength and direction of <strong>monotonic association</strong> between two ranked variables. It quantifies how consistently the order of one variable corresponds to the order of another.</em></p>
</blockquote>
<blockquote class="blockquote">
<p><em>2. Kendall’s <span class="math inline">\(\tau\)</span> is based on the <strong>number of concordant and discordant pairs</strong>, whereas Pearson’s <span class="math inline">\(r\)</span> measures <strong>linear association</strong> based on actual data values. Kendall’s <span class="math inline">\(\tau\)</span> is non-parametric and uses only rank order information.</em></p>
</blockquote>
<blockquote class="blockquote">
<p><em>3. A <strong>concordant pair</strong> is one where the relative ordering of two items is the same in both rankings (both increasing or both decreasing). A <strong>discordant pair</strong> is one where the order is reversed between the two rankings.</em></p>
</blockquote>
<blockquote class="blockquote">
<p><em>4. The general formula is:</em> <span class="math display">\[
\tau = \frac{C - D}{T} = \frac{C - D}{\frac{1}{2}n(n - 1)}
\]</span> <em>where <span class="math inline">\(C\)</span> is the number of concordant pairs, <span class="math inline">\(D\)</span> is the number of discordant pairs, and <span class="math inline">\(T\)</span> is the total number of distinct pairs.</em></p>
</blockquote>
<blockquote class="blockquote">
<p><em>5. <span class="math inline">\(\tau = +1\)</span> indicates perfect agreement (all pairs are concordant), <span class="math inline">\(\tau = 0\)</span> indicates no association (equal mix of concordant and discordant pairs), and <span class="math inline">\(\tau = -1\)</span> indicates perfect disagreement (all pairs are discordant).</em></p>
</blockquote>
<blockquote class="blockquote">
<p><em>6. Kendall’s <span class="math inline">\(\tau\)</span> is non-parametric because it does not assume any specific distribution of the variables or linearity of their relationship. It relies only on the ordinal information of the ranks rather than their numeric values.</em></p>
</blockquote>
<blockquote class="blockquote">
<p><em>7. Tied ranks reduce the number of distinct pairs that can be classified as concordant or discordant. Adjusted versions of Kendall’s <span class="math inline">\(\tau\)</span> (e.g., <span class="math inline">\(\tau_b\)</span>) include correction factors to handle ties in one or both rankings.</em></p>
</blockquote>
<blockquote class="blockquote">
<p><em>8. Kendall’s <span class="math inline">\(\tau\)</span> can be expressed as a difference in probabilities:</em> <span class="math display">\[
\tau = P(\text{concordant}) - P(\text{discordant})
\]</span> <em>meaning it represents how much more likely it is that two randomly chosen observations are ranked in the same order than in the opposite order.</em></p>
</blockquote>
<blockquote class="blockquote">
<p><em>9. Spearman’s <span class="math inline">\(\rho\)</span> is based on the <strong>differences between ranks</strong> and approximates Pearson’s <span class="math inline">\(r\)</span> computed on ranks, while Kendall’s <span class="math inline">\(\tau\)</span> directly counts <strong>pairwise order agreements</strong>. Both measure monotonic relationships, but Kendall’s <span class="math inline">\(\tau\)</span> is generally smaller in magnitude and has a clearer probabilistic interpretation.</em></p>
</blockquote>
<blockquote class="blockquote">
<p><em>10. Kendall’s <span class="math inline">\(\tau\)</span> is preferred for ordinal data because it depends only on the relative ordering of observations, making it robust to nonlinearity and outliers. Pearson’s <span class="math inline">\(r\)</span> assumes interval-scale data and linearity, which are often not valid for ranked responses.</em></p>
</blockquote>
<hr>
<blockquote class="blockquote">
<p><em>11. The value of <span class="math inline">\(\tau\)</span> would be close to <span class="math inline">\(+1\)</span>, since most pairs remain concordant and only one pair is discordant. A single reversal in a small dataset slightly lowers <span class="math inline">\(\tau\)</span> but does not change its sign.</em></p>
</blockquote>
<blockquote class="blockquote">
<p><em>12. The value of <span class="math inline">\(\tau\)</span> would likely fall between <span class="math inline">\(0.4\)</span> and <span class="math inline">\(0.8\)</span>, indicating a moderately strong positive monotonic association with some inconsistencies in the ordering.</em></p>
</blockquote>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../intro.html" class="pagination-link" aria-label="Introduction">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../Notebooks/Morris_Elementary_Effects.html" class="pagination-link" aria-label="Morris Sensitivity Analysis (Elementary Effects Method)">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Morris Sensitivity Analysis (Elementary Effects Method)</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>